fileVersion: 1
id: 3bb66d04-4736-4c00-b124-f5ad77370532
name: DIM_DATE_NODE
operation:
  config:
    dateColumnName: "\"DATE_COLUMN_NC\""
    daysToGenerate: 1000/*comment*/
    insertZeroKey: false
    insertZeroKeyDate: 11-11-1111/*comment*/
    insertZeroKeyStr: "'NA'/*comment*/"
    insertZeroKeySurrogateKey: 0/*comment*/
    postSQL: select current_timestamp /*comment*/
    preSQL: select current_timestamp /*comment*/
    startingDate: DATEADD(DAY, -100, CURRENT_DATE)/*comment*/
    testsEnabled: true
    truncateBefore: false
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET
  materializationType: view
  metadata:
    appliedNodeTests:
      - continueOnFailure: true
        description: ""
        name: Test
        runOrder: After
        templateString: /*comment*/
      - continueOnFailure: true
        description: ""
        name: Test 1
        runOrder: After
        templateString: ""
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 443c179e-637a-475d-b67c-acec70edfffc
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: DATE
        defaultValue: ""
        description: Date in the format YYYY-MM-DD
        isBusinessKey: true
        name: DATE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ config.dateColumnName }}"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: bb58f1ff-1851-4aee-8e41-b4f1094a5cb1
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Year in the format YYYY
        isYear: true
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: YEAR({{ config.dateColumnName }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: true
          isDistinct: true
        columnReference:
          columnCounter: 54e4fe68-ec4f-4bc7-8bdc-6a4cb905b6e5
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Month in the format MM
        isMonth: true
        name: MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: MONTH({{ config.dateColumnName }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: e80ed115-7d6d-45e5-be2a-005a83049398
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: CHAR(3)
        defaultValue: ""
        description: Month in the format MMM
        isMonthName: true
        name: MONTH_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: MONTHNAME({{ config.dateColumnName }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: true
          isDistinct: true
        columnReference:
          columnCounter: 012fe0f7-c077-4dd4-bbb1-10eb35207494
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Day in the format DD
        isDayOfMonth: true
        name: DAY_OF_MONTH
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DAY({{ config.dateColumnName }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 81b3184d-6836-489f-8e5b-404152d31f59
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: VARCHAR(9)
        defaultValue: ""
        description: Day of the Week in format DD
        isDayOfWeek: true
        name: DAY_OF_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DAYOFWEEK({{ config.dateColumnName }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: true
        columnReference:
          columnCounter: 044d4bb8-7f55-4c9c-aa6d-d01bf2dfdc90
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: VARCHAR(9)
        defaultValue: ""
        description: Day of the Week in format DDD
        isDayNameOfWeek: true
        name: DAY_NAME_OF_WEEK
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TO_CHAR({{ config.dateColumnName }}, 'Dy')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 0cc75ba0-42ef-465a-8b65-962b0ec1af1e
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Week of the Year
        isWeekOfYear: true
        name: WEEK_OF_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: WEEKOFYEAR({{ config.dateColumnName }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 2ad9f939-8ffb-4e3e-bd89-d7528acc1e16
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Day of the year
        isYearColumn: true
        name: DAY_OF_YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: DAYOFYEAR({{ config.dateColumnName }})
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 9a086920-8142-4703-ad96-5988623c712a
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Quarter Number of the year (1-4)
        isQuarterNumber: true
        name: QUARTER_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TO_NUMBER(TO_CHAR(DATE_PART('Q',{{config.dateColumnName}})), '9')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: eaefb834-94dc-4da6-82ac-5c77e5751a62
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: SMALLINT
        defaultValue: ""
        description: Year and the Quarter number in the format YYYYQQ
        isQuarter: true
        name: QUARTER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: TO_NUMBER(TO_CHAR({{config.dateColumnName}}, 'YYYY') || '0' || TO_CHAR(DATE_PART('Q',{{config.dateColumnName}})), '999999')
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 38a3a103-1954-46f8-a2e8-7ce12d36c55d
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: VARCHAR(9)
        defaultValue: ""
        description: Flag to check week day
        isFlagWeekDay: true
        name: FLAG_WEEK_DAY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CASE WHEN TO_CHAR({{config.dateColumnName }}, 'Dy') IN ('Sat','Sun') THEN 'N' ELSE 'Y' END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 42c496f6-52e8-490c-a336-9b39589e04c3
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: VARCHAR(9)
        defaultValue: ""
        description: Flag to check weekend
        isFlagWeekEnd: true
        name: FLAG_WEEK_END
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CASE WHEN TO_CHAR({{config.dateColumnName }}, 'Dy') IN ('Sat','Sun') THEN 'A' ELSE 'B' END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: c8e6c65f-5029-4788-9d8d-b2aa36af1326
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemCreateDate: true
        name: SYSTEM_CREATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests:
          hasNull: false
          isDistinct: false
        columnReference:
          columnCounter: 8b7c5a42-1cf6-465e-9ee3-0d7814d24c4c
          stepCounter: 3bb66d04-4736-4c00-b124-f5ad77370532
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemUpdateDate: true
        name: SYSTEM_UPDATE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CAST(CURRENT_TIMESTAMP AS TIMESTAMP)
    cteString: ""
    enabledColumnTestIDs:
      - hasNull
      - isDistinct
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies: []
        join:
          joinCondition: ""
        name: DIM_DATE_NODE
        noLinkRefs: []
  name: DIM_DATE_NODE
  overrideSQL: false
  schema: ""
  sqlType: "404"
  type: sql
  version: 1
type: Node
